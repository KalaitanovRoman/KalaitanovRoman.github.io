!function(t){var e={};function n(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports='<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Tariffs</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="../../assets/images/favicon.ico" type="image/x-icon"></head><body><div class="wrap"><div class="tariff-list"></div></div></body></html>'},function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(0),n(1);const s="&mdash;",i={["Земля"]:"#70603e",["ЗемляHD"]:"#5a4d32",["Вода"]:"#0075d9",["Вода HD"]:"#00549c",["Огонь"]:"#e74807",["Огонь HD"]:"#ad3606"},o=(t,e)=>{const n=Object.keys(i);let s;for(let e in n)t===n[e]&&(s=i[n[e]]);return`<span style="background-color: ${s}">${e} Мбит/с</span>`},r=t=>{const e=t.split("+")[0],n=Math.floor(1e3*new Date(+e));return new Date(n).toISOString().replace(/T.*/,"").split("-").reverse().join(".")},a=t=>t>1&&t<5?`${t} месяца`:t>=5?`${t} месяцев`:`${t} месяц`;class c{static getBreadcrumbs(t){const e=document.createElement("div");return e.innerHTML=`\n            <div class="breadcrumbs">\n                <button class="breadcrumbs_close"></button>\n                <div class="breadcrumbs_title">\n                    <h2>${t}</h2>\n                </div>\n            </div>`,e.innerHTML}static close(t){const e=document.querySelector("body");document.querySelectorAll(".popup-wrap").length<=1&&(e.style.overflow="auto"),e.removeChild(t)}static open(t){const e=document.querySelector("body"),n=document.createElement("div"),i=document.createElement("div"),{modalName:o,data:l,title:d,nextStep:p,isChoice:u}=t;let f=[];return e.style.overflow="hidden",n.id=o,n.className="popup-wrap",n.style.top=`${window.pageYOffset}px`,n.innerHTML=c.getBreadcrumbs(d),i.className="popup-list",l.forEach(({price:t})=>{f.push(t)}),l.forEach(t=>{const{id:e,title:n,price:o,pay_period:c,new_payday:l}=t,d=document.createElement("div"),h=Math.min(...f)*c-o,b=h>0,m=Number(localStorage.getItem("selectedTariffId"))===e;d.className=`popup-block block-id-${e}`,d.innerHTML=`\n                <div class="popup-block_title">\n                    <h3>${u?n:a(c)}</h3>\n                    ${m?'<i class="selected-tariff"></i>':""}\n                    <div class="separator"></div>\n                </div>\n                <div class="popup-block_description">\n                    <div class="popup-block_price">\n                        ${u?`<p>Период оплаты ${s} ${a(c)}</p>`:""}\n                        <p>${o/c} &#8381;/мес</p>\n                    </div>\n                    <div class="popup-block_payment">\n                        <p class="">разовый платёж ${s} ${o} &#8381;</p>\n                        ${u?`<p>со счёта спишется ${s} ${o}&#8381;</p>`:b?`<p>скидка ${s} ${h}&#8381;</p>`:""}\n                    </div>\n                    ${p?`<button class="next-step-button" data-tariff-id="${e}"></button>`:""}\n                    ${u?`<div class="popup-block_date">\n                            <p>вступит в силу ${s} сегодня</p>\n                            <p>активно до ${s} ${r(l)}</p>\n                        </div>\n                        <div class="separator"></div>`:""}\n                </div>\n                ${u?(()=>Number(localStorage.getItem("selectedTariffId"))===e?'<button class="choice-button selected">Выбрано</button>':'<button class="choice-button">Выбрать</button>')():""}`,i.appendChild(d)}),n.appendChild(i),e.appendChild(n)}}class l extends c{constructor(t,e){super(),this.data=t,this.title=e,this.render(),this.getEvents()}getEvents(){const t=document.querySelector("#tariff-choice-modal");t.addEventListener("click",e=>{const n=e.target;if(n.closest(".breadcrumbs_close")&&c.close(t),n.closest(".choice-button")){const t="Выбрано"===n.innerText?"Выбрать":"Выбрано",e="choice-button"===n.className?"choice-button selected":"choice-button";n.innerText=t,n.className=e}})}render(){const t={modalName:"tariff-choice-modal",data:this.data,title:this.title,nextStep:!1,isChoice:!0};c.open(t)}}class d extends c{constructor(t,e){super(),this.data=t,this.title=e,this.render(),this.getEvents()}getEvents(){const t=document.querySelector("#tariff-info-modal");t.addEventListener("click",e=>{const n=e.target,s=n.getAttribute("data-tariff-id");if(n.closest(".breadcrumbs_close")&&c.close(t),n.closest(".next-step-button"))for(let t of this.data)t.id===Number(s)&&new l([t],"Выбор тарифа")})}render(){const t={modalName:"tariff-info-modal",data:this.data,title:`Тариф "${this.title}"`,nextStep:!0};c.open(t)}}class p{constructor(t){this.data=t,this.render(),this.getEvents()}getFreeOptions(t){const e=document.createElement("div");return t.forEach(t=>{const n=document.createElement("p");n.innerText=t,e.appendChild(n)}),e.innerHTML}getPrice(t){let e,n,s=[];return t.forEach(({price:t})=>s.push(t)),`<span>${(n=Math.max(...s))/12} - ${e=Math.min(...s)} &#8381;/мес</span>`}getTariffBlocks(t){const e=document.createElement("div"),{title:n,speed:s,tarifs:i,free_options:r,link:a}=t;return e.className="tariff-block",e.innerHTML=`\n            <div class="tariff-block_title">\n                <h2>Тариф "${n}"</h2>\n                <div class="separator"></div>\n            </div>\n            <div class="tariff-block_description">\n                <div class="tariff-block_speed">\n                    ${o(n,s)}\n                </div>\n                <div class="tariff-block_price">\n                    ${this.getPrice(i)}\n                </div>\n                ${r?`<div class="tariff-block_options">\n                        ${this.getFreeOptions(r)}\n                    </div>`:""}\n                <button class="next-step-button" data-title="${n}"></button>\n                <div class="separator"></div>\n            </div>\n            <div class="tariff-block_link">\n                <a href="${a}" target="_blank">узнать подробнее на сайте</a>\n            </div>\n        `,e}getEvents(){document.querySelector(".tariff-list").addEventListener("click",t=>{const e=t.target,n=e.getAttribute("data-title");if(e.closest(".next-step-button"))for(let t of this.data)t.title===n&&new d(t.tarifs,t.title)})}render(){const t=document.querySelector(".tariff-list");this.data.forEach(e=>{t.appendChild(this.getTariffBlocks(e))})}}((t,e)=>new Promise((n,s)=>{let i=new XMLHttpRequest;i.open(t,e,!0),i.onload=()=>{if(200===i.status)n(JSON.parse(i.response));else{let t=new Error(i.statusText);t.code=status,s(t)}},i.send()}))("GET","https://next.json-generator.com/api/json/get/VkLDNSEWu").then(({tarifs:t})=>new p(t)).catch(t=>console.error(t)),console.log("all files loaded")}]);
//# sourceMappingURL=main.js.map