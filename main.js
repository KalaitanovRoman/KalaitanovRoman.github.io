!function(t){var e={};function n(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports='<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><title>Tariffs</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="../../assets/images/favicon.ico" type="image/x-icon"></head><body><div class="wrap"><div class="tariff-list"></div></div></body></html>'},function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(0),n(1);const s={["Земля"]:"#70603e",["ЗемляHD"]:"#5a4d32",["Вода"]:"#0075d9",["Вода HD"]:"#00549c",["Огонь"]:"#e74807",["Огонь HD"]:"#ad3606"},i=t=>t>1&&t<5?`${t} месяца`:t>=5?`${t} месяцев`:`${t} месяц`;class o{static getBreadcrumbs(t){const e=document.createElement("div");return e.innerHTML=`\n            <div class="breadcrumbs">\n                <button class="breadcrumbs_close"></button>\n                <div class="breadcrumbs_title">\n                    <h2>${t}</h2>\n                </div>\n            </div>`,e.innerHTML}static close(t){const e=document.querySelector("body");document.querySelectorAll(".popup-wrap").length<=1&&(e.style.overflow="auto"),e.removeChild(t)}static open(t){const e=document.querySelector("body"),n=document.createElement("div"),s=document.createElement("div"),{modalName:r,data:a,title:c,nextStep:l,isChoice:d}=t;let p=[];return e.style.overflow="hidden",n.id=r,n.className="popup-wrap",n.style.top=`${window.pageYOffset}px`,n.innerHTML=o.getBreadcrumbs(c),s.className="popup-list",a.forEach(({price:t})=>{p.push(t)}),a.forEach(t=>{const{id:e,title:n,price:o,pay_period:r,new_payday:a}=t,c=document.createElement("div"),u=Math.min(...p)*r-o,f=u>0,h=Number(localStorage.getItem("selectedTariffId"))===e;c.className=`popup-block block-id-${e}`,c.innerHTML=`\n                <div class="popup-block_title">\n                    <h3>${d?n:i(r)}</h3>\n                    ${h?'<i class="selected-tariff"></i>':""}\n                    <div class="separator"></div>\n                </div>\n                <div class="popup-block_description">\n                    <div class="popup-block_price">\n                        ${d?`<p>Период оплаты &mdash; ${i(r)}</p>`:""}\n                        <p>${o/r} &#8381;/мес</p>\n                    </div>\n                    <div class="popup-block_payment">\n                        <p class="">разовый платёж &mdash; ${o} &#8381;</p>\n                        ${d?`<p>со счёта спишется &mdash; ${o}&#8381;</p>`:f?`<p>скидка &mdash; ${u}&#8381;</p>`:""}\n                    </div>\n                    ${l?`<button class="next-step-button" data-tariff-id="${e}"></button>`:""}\n                    ${d?`<div class="popup-block_date">\n                            <p>вступит в силу &mdash; сегодня</p>\n                            <p>активно до &mdash; ${(t=>{const e=t.split("+")[0],n=Math.floor(1e3*new Date(+e));return new Date(n).toISOString().replace(/T.*/,"").split("-").reverse().join(".")})(a)}</p>\n                        </div>\n                        <div class="separator"></div>`:""}\n                </div>\n                ${d?Number(localStorage.getItem("selectedTariffId"))===e?'<button class="choice-button selected">Выбрано</button>':'<button class="choice-button">Выбрать</button>':""}`,s.appendChild(c)}),n.appendChild(s),e.appendChild(n)}}class r extends o{constructor(t,e){super(),this.data=t,this.title=e,this.render(),this.getEvents()}getEvents(){const t=document.querySelector("#tariff-choice-modal");t.addEventListener("click",e=>{const n=e.target;if(n.closest(".breadcrumbs_close")&&o.close(t),n.closest(".choice-button")){const t="Выбрано"===n.innerText?"Выбрать":"Выбрано",e="choice-button"===n.className?"choice-button selected":"choice-button";n.innerText=t,n.className=e}})}render(){const t={modalName:"tariff-choice-modal",data:this.data,title:this.title,nextStep:!1,isChoice:!0};o.open(t)}}class a extends o{constructor(t,e){super(),this.data=t,this.title=e,this.render(),this.getEvents()}getEvents(){const t=document.querySelector("#tariff-info-modal");t.addEventListener("click",e=>{const n=e.target,s=n.getAttribute("data-tariff-id");if(n.closest(".breadcrumbs_close")&&o.close(t),n.closest(".next-step-button"))for(let t of this.data)t.id===Number(s)&&new r([t],"Выбор тарифа")})}render(){const t={modalName:"tariff-info-modal",data:this.data,title:`Тариф "${this.title}"`,nextStep:!0};o.open(t)}}class c{constructor(t){this.data=t,this.render(),this.getEvents()}getFreeOptions(t){const e=document.createElement("div");return t.forEach(t=>{const n=document.createElement("p");n.innerText=t,e.appendChild(n)}),e.innerHTML}getPrice(t){let e,n,s=[];return t.forEach(({price:t})=>s.push(t)),n=Math.max(...s),e=Math.min(...s),`<span>${n/12} - ${e} &#8381;/мес</span>`}getTariffBlocks(t){const e=document.createElement("div"),{title:n,speed:i,tariffs:o,free_options:r,link:a}=t;return e.className="tariff-block",e.innerHTML=`\n            <div class="tariff-block_title">\n                <h2>Тариф "${n}"</h2>\n                <div class="separator"></div>\n            </div>\n            <div class="tariff-block_description">\n                <div class="tariff-block_speed">\n                    ${((t,e)=>{const n=Object.keys(s);let i;for(let e in n)t===n[e]&&(i=s[n[e]]);return`<span style="background-color: ${i}">${e} Мбит/с</span>`})(n,i)}\n                </div>\n                <div class="tariff-block_price">\n                    ${this.getPrice(o)}\n                </div>\n                ${r?`<div class="tariff-block_options">\n                        ${this.getFreeOptions(r)}\n                    </div>`:""}\n                <button class="next-step-button" data-title="${n}"></button>\n                <div class="separator"></div>\n            </div>\n            <div class="tariff-block_link">\n                <a href="${a}" target="_blank">узнать подробнее на сайте</a>\n            </div>\n        `,e}getEvents(){document.querySelector(".tariff-list").addEventListener("click",t=>{const e=t.target,n=e.getAttribute("data-title");if(e.closest(".next-step-button"))for(let t of this.data)t.title===n&&new a(t.tariffs,t.title)})}render(){const t=document.querySelector(".tariff-list");this.data.forEach(e=>{t.appendChild(this.getTariffBlocks(e))})}}((t,e="GET")=>new Promise((n,s)=>{let i=new XMLHttpRequest;i.open(e,t,!0),i.onload=()=>{if(200===i.status)n(JSON.parse(i.response));else{let t=new Error(i.statusText);t.code=status,s(t)}},i.send()}))("https://next.json-generator.com/api/json/get/VkLDNSEWu").then(({tariffs:t})=>new c(t)).catch(t=>console.error(t)),console.log("all files loaded")}]);
//# sourceMappingURL=main.js.map